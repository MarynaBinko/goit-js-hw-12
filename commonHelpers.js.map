{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\n// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n\n// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\n\nconst gallery = new SimpleLightbox('.gallery a',{\n    overlayOpacity: 8,\n    captionData: \"href\",\n    captionDelay: 250,\n    captionClass: \"text-center\"\n  });\n\n\n\nconst container = document.querySelector(\".gallery\");\nconst form = document.querySelector(\".form\");\nconst loadBtn = document.querySelector(\".load-btn\");\nform.addEventListener(\"submit\", handleSubmit);\nloadBtn.addEventListener(\"click\", handleLoadMore);\nconst loader = document.getElementById('loader');\n \nlet page = 1;\nlet per_page = 15;\nloader.style.display = 'none';\n\nasync function handleSubmit(event){\n    event.preventDefault();\n    const input = form.querySelector(\"input[type='text']\");\n    const searchQuery = input.value;\n\n    loader.style.display = 'inline-block';\n    container.innerHTML = \"\";\n    try{\n        const { hits, totalHits } = await searchPictures(searchQuery);\n      \n     if (hits.length === 0 ||  totalHits <= 0 ) {   \n        loader.style.display = 'none';\n        loadBtn.style.display = 'none';           \n        const errorMsg = `<i class=\"fa-solid fa-xmark\"></i>Sorry, there are no images matching your search query. Please try again!`;\n        showToast(errorMsg);\n               \n        \n    }else if (hits.length  <= per_page) {\n        container.insertAdjacentHTML(\"beforeend\", createMarkup(hits));       \n        gallery.refresh();\n        page ++;        \n        loadBtn.style.marginBottom = '50px';\n        loadBtn.style.display = 'block';\n       \n    }       \n        \n\n        }\n    catch {(error) => {\n        const errorMsg = `<i class=\"fa-solid fa-xmark\"></i>Sorry, there are no images matching your search query. Please try again!`;\n        showToast(errorMsg)\n        \n        }\n}\nfinally{ \n   loader.style.display = 'none';\n   form.reset();\n      }\n}\n\n\nasync function handleLoadMore() {\n    try {               \n        loader.style.display = 'flex';\n        loader.style.position = \"fixed\";\n        loader.style.bottom = \"0\";\n        loader.style.left = \"50%\"; \n        loader.style.transform = \"translateX(-50%)\";\n        \n        \n        const { hits, totalPages  } = await searchPictures(form.querySelector(\"input[type='text']\").value);\n       \n        \n        if (page >= totalPages) {\n            loadBtn.style.display = 'none';\n            const  message = `<i class=\"fa-solid fa-xmark\"></i>We're sorry, but you've reached the end of search results.`;\n            showToast(message);             \n              \n        }\n        else{container.insertAdjacentHTML(\"beforeend\", createMarkup(hits));\n            gallery.refresh();       \n             page++;\n            }\n        const cardHeight = document.querySelector('.list-item').getBoundingClientRect().height;\n        window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n    } catch (error) {        \n        const errorMsg = `<i class=\"fa-solid fa-xmark\"></i>We're sorry, but you've reached the end of search results.`;\n        showToast(errorMsg);\n        loadBtn.style.display = 'none';\n\n    } finally {\n        \n        loader.style.display = 'none';\n      \n       \n    }\n}\n\n\n\nconst  API_KEY = \"43197174-dcc5f5044572d8f441379a766\";\n\nasync function searchPictures(searchQuery){\n    const params = new URLSearchParams({\n        key: API_KEY,\n        q: searchQuery,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: per_page,\n        page: page\n    });\n    \n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\nconsole.log(response);\n    const { hits, totalHits } = response.data; \n    const totalPages = Math.ceil(totalHits / per_page);    \n    return { hits, totalHits, totalPages };\n    \n}\n\n\nfunction createMarkup(arr) {\n    return  arr.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) =>{\n        return `   \n        <li class=\"list-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img  class=\"list-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n            <div class=\"image-details\">          \n                <p class=\"likes\"><span class=\"span\">Likes:</span><br> <span class=\"span-link\">${likes}</span> </p>\n                <p class=\"views\"><span class=\"span\">Views:</span><br> <span class=\"span-link\">${views}</span>  </p>                                \n                <p class=\"comments\"><span class=\"span\">Comments:</span><br> <span class=\"span-link\">${comments}</span></p>               \n                <p class=\"downloads\"><span class=\"span\">Downloads:</span><br> <span class=\"span-link\">${downloads}</span></p>                           \n            </div>\n        </li>`; })\n    .join(\"\")\n    ;\n}\n\n\nlet toastBox = document.getElementById(`toastBox`);\nfunction showToast(message) {\n    let toast = document.createElement(`div`);\n    toast.classList.add(`toast`);   \n    toast.innerHTML = message;\n\n    toastBox.appendChild(toast);\n\n    \n    setTimeout(() => {\n        toast.remove();\n    }, 3000);\n    \n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// function handleSubmit(event) {\n//     event.preventDefault();\n    \n//     const input = form.querySelector(\"input[type='text']\");\n//     const searchQuery = input.value;\n\n//     loader.style.display = 'flex';\n//     container.innerHTML = \"\";\n   \n//     searchPictures(searchQuery)       \n//     .then(data => {\n//         const hits = data.hits;\n// if (hits.length === 0) {\n//     const errorMsg = `<i class=\"fa-solid fa-xmark\"></i>Sorry, there are no images matching your search query. Please try again!`;\n//     showToast(errorMsg);\n// }else{ \n//     container.innerHTML = createMarkup(hits);\n//     gallery.refresh();}\n       \n//     })\n//     .catch(error => {\n//             const errorMsg = `<i class=\"fa-solid fa-xmark\"></i>Sorry, there are no images matching your search query. Please try again!`;\n//             showToast(errorMsg)\n//         })\n    \n//     .finally(()=> { loader.style.display = 'none';\n//     form.reset()})\n//     }\n\n// const  API_KEY = \"43197174-dcc5f5044572d8f441379a766\";\n\n// function searchPictures(searchQuery){\n//     const params = new URLSearchParams({\n//         key: API_KEY,\n//         q: searchQuery,\n//         image_type: \"photo\",\n//         orientation: \"horizontal\",\n//         safesearch: true,\n//     });\n \n//     return fetch(`https://pixabay.com/api/?${params}`)\n//     .then(response => {\n//         if(!response.ok){\n//             throw new Error(showToast(errorMsg));\n//         }\n//         return response.json()\n//     })\n \n// }\n\n\n// function createMarkup(arr) {\n//     return  arr.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) =>{\n//         return `   \n//         <li class=\"list-item\">\n//         <a class=\"gallery-link\" href=\"${largeImageURL}\">\n//             <img  class=\"list-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n//             <div class=\"image-details\">          \n//                 <p class=\"likes\"><span class=\"span\">Likes:</span><br> <span class=\"span-link\">${likes}</span> </p>\n//                 <p class=\"views\"><span class=\"span\">Views:</span><br> <span class=\"span-link\">${views}</span>  </p>                                \n//                 <p class=\"comments\"><span class=\"span\">Comments:</span><br> <span class=\"span-link\">${comments}</span></p>               \n//                 <p class=\"downloads\"><span class=\"span\">Downloads:</span><br> <span class=\"span-link\">${downloads}</span></p>                           \n//             </div>\n//         </li>`; })\n//     .join(\"\")\n//     ;\n// }\n\n\n\n\n// let toastBox = document.getElementById(`toastBox`);\n// function showToast(message) {\n//     let toast = document.createElement(`div`);\n//     toast.classList.add(`toast`);   \n//     toast.innerHTML = message;\n\n//     toastBox.appendChild(toast);\n\n    \n//     setTimeout(() => {\n//         toast.remove();\n//     }, 3000);\n    \n// };\n\n\n// const loader = document.getElementById('loader');"],"names":["gallery","SimpleLightbox","container","form","loadBtn","handleSubmit","handleLoadMore","loader","page","per_page","event","searchQuery","hits","totalHits","searchPictures","showToast","createMarkup","totalPages","cardHeight","API_KEY","params","response","axios","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","toastBox","message","toast"],"mappings":"6vBAgBA,MAAMA,EAAU,IAAIC,EAAe,aAAa,CAC5C,eAAgB,EAChB,YAAa,OACb,aAAc,IACd,aAAc,aAClB,CAAG,EAIGC,EAAY,SAAS,cAAc,UAAU,EAC7CC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,WAAW,EAClDD,EAAK,iBAAiB,SAAUE,CAAY,EAC5CD,EAAQ,iBAAiB,QAASE,CAAc,EAChD,MAAMC,EAAS,SAAS,eAAe,QAAQ,EAE/C,IAAIC,EAAO,EACPC,EAAW,GACfF,EAAO,MAAM,QAAU,OAEvB,eAAeF,EAAaK,EAAM,CAC9BA,EAAM,eAAc,EAEpB,MAAMC,EADQR,EAAK,cAAc,oBAAoB,EAC3B,MAE1BI,EAAO,MAAM,QAAU,eACvBL,EAAU,UAAY,GACtB,GAAG,CACC,KAAM,CAAE,KAAAU,EAAM,UAAAC,CAAS,EAAK,MAAMC,EAAeH,CAAW,EAE3DC,EAAK,SAAW,GAAMC,GAAa,GACpCN,EAAO,MAAM,QAAU,OACvBH,EAAQ,MAAM,QAAU,OAExBW,EADiB,2GACC,GAGZH,EAAK,QAAWH,IACtBP,EAAU,mBAAmB,YAAac,EAAaJ,CAAI,CAAC,EAC5DZ,EAAQ,QAAO,EACfQ,IACAJ,EAAQ,MAAM,aAAe,OAC7BA,EAAQ,MAAM,QAAU,QAKvB,MACC,CAKV,QACA,CACGG,EAAO,MAAM,QAAU,OACvBJ,EAAK,MAAK,CACN,CACP,CAGA,eAAeG,GAAiB,CAC5B,GAAI,CACAC,EAAO,MAAM,QAAU,OACvBA,EAAO,MAAM,SAAW,QACxBA,EAAO,MAAM,OAAS,IACtBA,EAAO,MAAM,KAAO,MACpBA,EAAO,MAAM,UAAY,mBAGzB,KAAM,CAAE,KAAAK,EAAM,WAAAK,CAAU,EAAM,MAAMH,EAAeX,EAAK,cAAc,oBAAoB,EAAE,KAAK,EAG7FK,GAAQS,GACRb,EAAQ,MAAM,QAAU,OAExBW,EADiB,6FACA,IAGhBb,EAAU,mBAAmB,YAAac,EAAaJ,CAAI,CAAC,EAC7DZ,EAAQ,QAAO,EACdQ,KAEL,MAAMU,EAAa,SAAS,cAAc,YAAY,EAAE,sBAAuB,EAAC,OAChF,OAAO,SAAS,CAAE,IAAKA,EAAa,EAAG,SAAU,QAAQ,CAAE,CAC9D,MAAe,CAEZH,EADiB,6FACC,EAClBX,EAAQ,MAAM,QAAU,MAEhC,QAAc,CAENG,EAAO,MAAM,QAAU,MAG1B,CACL,CAIA,MAAOY,EAAU,qCAEjB,eAAeL,EAAeH,EAAY,CACtC,MAAMS,EAAS,IAAI,gBAAgB,CAC/B,IAAKD,EACL,EAAGR,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMD,CACd,CAAK,EAEKa,EAAW,MAAMC,EAAM,IAAI,4BAA4BF,CAAM,EAAE,EACzE,QAAQ,IAAIC,CAAQ,EAChB,KAAM,CAAE,KAAAT,EAAM,UAAAC,GAAcQ,EAAS,KAC/BJ,EAAa,KAAK,KAAKJ,EAAYJ,CAAQ,EACjD,MAAO,CAAE,KAAAG,EAAM,UAAAC,EAAW,WAAAI,EAE9B,CAGA,SAASD,EAAaO,EAAK,CACvB,OAAQA,EAAI,IAAI,CAAC,CAAC,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAC3E;AAAA;AAAA,wCAEyBL,CAAa;AAAA,4CACTD,CAAY,UAAUE,CAAI;AAAA;AAAA,gGAE0BC,CAAK;AAAA,gGACLC,CAAK;AAAA,sGACCC,CAAQ;AAAA,wGACNC,CAAS;AAAA;AAAA,cAEhG,EACZ,KAAK,EAAE,CAEZ,CAGA,IAAIC,EAAW,SAAS,eAAe,UAAU,EACjD,SAAShB,EAAUiB,EAAS,CACxB,IAAIC,EAAQ,SAAS,cAAc,KAAK,EACxCA,EAAM,UAAU,IAAI,OAAO,EAC3BA,EAAM,UAAYD,EAElBD,EAAS,YAAYE,CAAK,EAG1B,WAAW,IAAM,CACbA,EAAM,OAAM,CACf,EAAE,GAAI,CAEX"}